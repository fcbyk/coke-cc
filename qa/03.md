# CMake 构建工具

---

<CCollapseGroup>

<CCollapse title="什么是 CMake？">

CMake 是一个**跨平台的自动化构建系统**，它使用简单的配置文件（CMakeLists.txt）来生成标准的构建文件（如 Makefile 或 Visual Studio 项目文件），从而简化了 C/C++ 项目的编译过程。

- **不是编译器**：CMake 本身不编译代码，而是生成用于编译的配置文件
- **跨平台支持**：可以在 Windows、Linux、macOS 上使用
- **简化构建**：通过配置文件管理复杂的编译流程和依赖关系

</CCollapse>

<CCollapse title="为什么需要 CMake？">

当 C++ 项目变得复杂时，手动编译会非常麻烦：

1. **多文件管理**：项目有多个 .cpp 和 .hpp 文件时，需要手动指定所有文件
2. **依赖关系**：需要确保正确的编译顺序和链接库
3. **跨平台问题**：不同操作系统下的编译方式不同
4. **配置复杂**：需要设置编译器选项、包含路径、链接库等

CMake 通过配置文件自动处理这些问题，让构建过程更加简单和可维护。

</CCollapse>

<CCollapse title="如何安装 CMake？">

CLion内置了CMake，独立安装暂时不需要掌握，感兴趣可以询问AI。

</CCollapse>

<CCollapse title="如何手动创建一个 CMake 项目？">

1. 创建项目文件夹和源文件：
```
CokeCC/
├── CMakeLists.txt
└── main.cpp
```

2. 编写简单的 main.cpp
```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello CMake!" << endl;
    return 0;
}
```

3. 编写 CMakeLists.txt：
```cmake
# 指定最低 CMake 版本要求
cmake_minimum_required(VERSION 3.10)

# 设置项目名称
project(CokeCC)

# 设置 C++ 标准，即用哪个版本的编译器
set(CMAKE_CXX_STANDARD 17)

# 添加可执行文件
add_executable(app main.cpp)
```

4. 在终端输入命令编译项目（无需掌握），掌握在CLion编译项目即可。

<template #extra>
    <CBadge text="重点" variant="outline" color="#ff4d4f" />
</template>

</CCollapse>

<CCollapse title="CMakeLists.txt 需要掌握基本语法？">

> - 写​​需要重点掌握 `add_executable` 的语法
> - CMakeLists.txt 中的 ​`​配置指令不区分大小写`

```cmake
# 以#号开头的是注释

# 设置 CMake 最低版本要求
cmake_minimum_required(VERSION 3.10)

# 定义项目名称
project(MyProject)

# 设置 C++ 标准
set(CMAKE_CXX_STANDARD 17)

# 把当前文件夹的source1.cpp 和 source2.cpp 编译为 app1.exe
add_executable(app1 source1.cpp source2.cpp)

# 把src文件夹的source3.cpp 编译为 app2.exe
add_executable(app2 src/source3.cpp)
```

<template #extra>
    <CBadge text="重点" variant="outline" color="#ff4d4f" />
</template>

</CCollapse>

<CCollapse title="CLion 中的 CMake 工作流程？">

#### 自动检测和配置
1. 打开项目文件夹
2. CLion 自动检测 CMakeLists.txt
3. 解析项目结构和依赖
4. 生成构建缓存和索引
5. 准备好智能代码补全和错误检查

#### 构建执行过程
1. 点击 Build 按钮
2. CLion 调用内置 CMake
3. 生成平台特定的构建文件（如Window平台）
4. CLion 调用底层构建工具
5. 编译器 g++/clang/MSVC 执行编译
6. 输出可执行文件

</CCollapse>


</CCollapseGroup>